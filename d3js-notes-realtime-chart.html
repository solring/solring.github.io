
<!DOCTYPE html>
<html lang="chinese (traditional)">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="./theme/pygments/monokai.min.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/font-awesome.min.css">


    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Solring Lin Atom">





<meta name="author" content="Solring Lin" />
<meta name="description" content="(archive) D3.js notes realtime chart" />
<meta name="keywords" content="">

<meta property="og:site_name" content="Solring Lin"/>
<meta property="og:title" content="D3.js notes realtime chart"/>
<meta property="og:description" content="(archive) D3.js notes realtime chart"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./d3js-notes-realtime-chart.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-09-30 07:24:00+08:00"/>
<meta property="article:modified_time" content="2016-09-30 07:24:00+08:00"/>
<meta property="article:author" content="./author/solring-lin.html">
<meta property="article:section" content="Archive"/>
<meta property="og:image" content="images/profile.jpg">

  <title>Solring Lin &ndash; D3.js notes realtime chart</title>

</head>
<body>
  <aside>
    <div>
      <a href=".">
        <img src="images/profile.jpg" alt="SOLRING LIN" title="SOLRING LIN">
      </a>
      <h1><a href=".">SOLRING LIN</a></h1>

<p>Software Developer | Technical notes and everything</p>
      <nav>
        <ul class="list">

          <li><a href="/about.html" target="_blank">About</a></li>
          <li><a href="https://www.linkedin.com/in/sherry-lin-73312843/" target="_blank">Resume</a></li>
          <li><a href="#" target="_blank">sherry12714@gmail.com</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="http://github.com/solring" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/sherry-lin-73312843/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-twitter" href="http://twitter.com/solringlin" target="_blank"><i class="fa fa-twitter"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href=".">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="d3js-notes-realtime-chart">D3.js notes realtime chart</h1>
    <p>
          Posted on 週五 30 九月 2016 in <a href="./category/archive.html">Archive</a>


    </p>
  </header>


  <div>
    <p>http://bl.ocks.org/simenbrekken/6634070
https://bl.ocks.org/boeric/6a83de20f780b42fadb9</p>
<div class="highlight"><pre><span></span><span class="o">&lt;!</span><span class="nx">doctype</span> <span class="nx">html</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">html</span> <span class="nx">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">charset</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="o">&gt;</span>
  <span class="c">&lt;!--</span> <span class="nx">Author</span>: <span class="kt">Bo</span> <span class="nx">Ericsson</span> <span class="o">--&gt;</span>
  <span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Real</span> <span class="nx">Time</span> <span class="nx">Chart</span> <span class="nx">Multi</span><span class="o">&lt;</span><span class="err">/title&gt;</span>
  <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="nx">stylesheet</span> <span class="nx">type</span><span class="o">=</span><span class="nx">text</span><span class="o">/</span><span class="nx">css</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap.min.css&quot;</span> <span class="nx">media</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="o">&gt;</span>
  <span class="c">&lt;!--</span><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="nx">stylesheet</span> <span class="nx">type</span><span class="o">=</span><span class="nx">text</span><span class="o">/</span><span class="nx">css</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;../_lib/bootstrap.min.css&quot;</span> <span class="nx">media</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="o">&gt;--&gt;</span>
  <span class="o">&lt;</span><span class="nx">style</span><span class="o">&gt;</span>
  <span class="p">.</span><span class="nx">axis</span> <span class="nx">text</span> <span class="p">{</span>
    <span class="nx">font</span>: <span class="kt">10px</span> <span class="nx">sans</span><span class="o">-</span><span class="nx">serif</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">chartTitle</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span>: <span class="kt">18px</span><span class="p">;</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">weight</span>: <span class="kt">bold</span><span class="p">;</span>
    <span class="nx">text</span><span class="o">-</span><span class="nx">anchor</span>: <span class="kt">middle</span><span class="p">;</span> 
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">axis</span> <span class="p">.</span><span class="nx">title</span> <span class="p">{</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">size</span>: <span class="kt">18px</span><span class="p">;</span>
    <span class="nx">font</span><span class="o">-</span><span class="nx">weight</span>: <span class="kt">bold</span><span class="p">;</span>
    <span class="nx">text</span><span class="o">-</span><span class="nx">anchor</span>: <span class="kt">middle</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">axis</span> <span class="nx">path</span><span class="p">,</span>
  <span class="p">.</span><span class="nx">axis</span> <span class="nx">line</span> <span class="p">{</span>
    <span class="nx">fill</span>: <span class="kt">none</span><span class="p">;</span>
    <span class="nx">stroke</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span><span class="p">;</span>
    <span class="nx">shape</span><span class="o">-</span><span class="nx">rendering</span>: <span class="kt">crispEdges</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">x</span><span class="p">.</span><span class="nx">axis</span> <span class="nx">path</span> <span class="p">{</span>
    <span class="nx">fill</span>: <span class="kt">none</span><span class="p">;</span>
    <span class="nx">stroke</span><span class="o">:</span> <span class="err">#</span><span class="mi">000</span><span class="p">;</span>
    <span class="nx">shape</span><span class="o">-</span><span class="nx">rendering</span>: <span class="kt">crispEdges</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">nav</span> <span class="p">.</span><span class="nx">area</span> <span class="p">{</span>
    <span class="nx">fill</span>: <span class="kt">lightgrey</span><span class="p">;</span>
    <span class="nx">stroke</span><span class="o">-</span><span class="nx">width</span>: <span class="kt">0px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">nav</span> <span class="p">.</span><span class="nx">line</span> <span class="p">{</span>
    <span class="nx">fill</span>: <span class="kt">none</span><span class="p">;</span>
    <span class="nx">stroke</span>: <span class="kt">darkgrey</span><span class="p">;</span>
    <span class="nx">stroke</span><span class="o">-</span><span class="nx">width</span>: <span class="kt">1px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">viewport</span> <span class="p">{</span>
    <span class="nx">stroke</span>: <span class="kt">grey</span><span class="p">;</span>
    <span class="nx">fill</span>: <span class="kt">black</span><span class="p">;</span>
    <span class="nx">fill</span><span class="o">-</span><span class="nx">opacity</span>: <span class="kt">0.3</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">viewport</span> <span class="p">.</span><span class="nx">extent</span> <span class="p">{</span>
    <span class="nx">fill</span>: <span class="kt">orange</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">.</span><span class="nx">well</span> <span class="p">{</span>
    <span class="nx">padding</span><span class="o">-</span><span class="nx">top</span>: <span class="kt">0px</span><span class="p">;</span>
    <span class="nx">padding</span><span class="o">-</span><span class="nx">bottom</span>: <span class="kt">0px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="o">&lt;</span><span class="err">/style&gt;</span>
<span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;max-width: 900px; max-height: 400px; padding: 10px&quot;</span><span class="o">&gt;</span>

  <span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;well&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">h4</span><span class="o">&gt;</span><span class="nx">Energy</span> <span class="nx">Aware</span> <span class="nx">Scheduler</span> <span class="nx">Performance</span> <span class="o">&amp;</span> <span class="nx">Power</span> <span class="nx">Consumption</span>
  <span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;margin-bottom: 10px&quot;</span> <span class="o">/&gt;</span> <span class="nx">Debug</span>
  <span class="o">&lt;</span><span class="nx">input</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;halt&quot;</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;halt&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;halt&quot;</span> <span class="nx">style</span><span class="o">=</span><span class="s2">&quot;margin-bottom: 10px&quot;</span> <span class="o">/&gt;</span> <span class="nx">Halt</span>

  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;viewDiv1&quot;</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>
  <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">id</span><span class="o">=</span><span class="s2">&quot;viewDiv2&quot;</span><span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>

<span class="o">&lt;</span><span class="err">/div&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="c">&lt;!--</span><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;../_lib/d3.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;--&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;realTimeChartMulti.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">cat1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;with EAS&quot;</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">cat2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;with EAS&quot;</span><span class="p">,</span> <span class="s2">&quot;lagacy&quot;</span><span class="p">];</span>

<span class="c1">// create the real time chart</span>
<span class="kd">var</span> <span class="nx">chart1</span> <span class="o">=</span> <span class="nx">realTimeChartMulti</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">title</span><span class="p">(</span><span class="s2">&quot;Performance&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">yTitle</span><span class="p">(</span><span class="s2">&quot;FPS&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">xTitle</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">yDomain</span><span class="p">(</span><span class="nx">cat1</span><span class="p">)</span> <span class="c1">// initial y domain (note array)</span>
    <span class="p">.</span><span class="nx">border</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">height</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">chart2</span> <span class="o">=</span> <span class="nx">realTimeChartMulti</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">title</span><span class="p">(</span><span class="s2">&quot;Power Consumption&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">yTitle</span><span class="p">(</span><span class="s2">&quot;Current(mA)&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">xTitle</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">yDomain</span><span class="p">(</span><span class="nx">cat2</span><span class="p">)</span> <span class="c1">// initial y domain (note array)</span>
    <span class="p">.</span><span class="nx">border</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">width</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">height</span><span class="p">(</span><span class="mi">350</span><span class="p">);</span>

<span class="c1">// invoke the chart</span>
<span class="kd">var</span> <span class="nx">chartDiv1</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#viewDiv1&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;chartDiv1&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">chart1</span><span class="p">);</span>

    <span class="c1">// invoke the chart</span>
<span class="kd">var</span> <span class="nx">chartDiv2</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#viewDiv2&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;chartDiv2&quot;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">chart2</span><span class="p">);</span>

<span class="c1">// alternative and equivalent invocation</span>
<span class="c1">//chart(chartDiv); </span>

<span class="c1">// event handler for debug checkbox</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#debug&quot;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">property</span><span class="p">(</span><span class="s2">&quot;checked&quot;</span><span class="p">)</span>
  <span class="nx">chart1</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
  <span class="nx">chart2</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="p">})</span>

<span class="c1">// event handler for halt checkbox</span>
<span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="s2">&quot;#halt&quot;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">property</span><span class="p">(</span><span class="s2">&quot;checked&quot;</span><span class="p">)</span>
  <span class="nx">chart1</span><span class="p">.</span><span class="nx">halt</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
  <span class="nx">chart2</span><span class="p">.</span><span class="nx">halt</span><span class="p">(</span><span class="nx">state</span><span class="p">);</span>
<span class="p">})</span>


<span class="c1">// configure the data generator</span>

<span class="c1">// mean and deviation for generation of time intervals</span>
<span class="kd">var</span> <span class="nx">tX</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">// time constant, multiple of one second</span>
<span class="kd">var</span> <span class="nx">meanMs</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">,</span> <span class="c1">// milliseconds</span>
    <span class="nx">dev</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">;</span> <span class="c1">// std dev</span>

<span class="c1">// define time scale</span>
<span class="kd">var</span> <span class="nx">timeScale</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">linear</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">domain</span><span class="p">([</span><span class="mi">300</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">,</span> <span class="mi">1700</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">range</span><span class="p">([</span><span class="mi">300</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">,</span> <span class="mi">1700</span> <span class="o">*</span> <span class="nx">tX</span><span class="p">])</span>
    <span class="p">.</span><span class="nx">clamp</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="c1">// define function that returns normally distributed random numbers</span>
<span class="kd">var</span> <span class="nx">normal</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">random</span><span class="p">.</span><span class="nx">normal</span><span class="p">(</span><span class="nx">meanMs</span><span class="p">,</span> <span class="nx">dev</span><span class="p">);</span>

<span class="c1">// define color scale</span>
<span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">scale</span><span class="p">.</span><span class="nx">category10</span><span class="p">();</span>

<span class="c1">// in a normal use case, real time data would arrive through the network or some other mechanism</span>
<span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;rect&quot;</span><span class="p">,</span> <span class="s2">&quot;circle&quot;</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">// define data generator</span>
<span class="kd">function</span> <span class="nx">dataGenerator() {</span>

  <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

    <span class="c1">// output a sample for each category, each interval (five seconds)</span>
    <span class="nx">chart1</span><span class="p">.</span><span class="nx">yDomain</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">cat</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// create randomized timestamp for this category data item</span>
      <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">*</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// create new data item</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">// complex data item; four attributes (type, color, opacity and size) are changing dynamically with each iteration (as an example)</span>
        <span class="nx">time</span>: <span class="kt">now</span><span class="p">,</span>
        <span class="nx">color</span>: <span class="kt">color</span><span class="p">(</span><span class="nx">d</span> <span class="o">%</span> <span class="mi">10</span><span class="p">),</span>
        <span class="nx">opacity</span>: <span class="kt">Math.max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="nx">category</span>: <span class="kt">cat1</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
        <span class="c1">//type: shapes[Math.round(Math.random() * (shapes.length - 1))], // the module currently doesn&#39;t support dynamically changed svg types (need to add key function to data, or method to dynamically replace svg object – tbd)</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
        <span class="nx">size</span>: <span class="kt">Math.max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
      <span class="p">};</span>

      <span class="c1">// send the datum to the chart</span>
      <span class="nx">chart1</span><span class="p">.</span><span class="nx">datum</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>      
    <span class="p">});</span>

    <span class="c1">// output a sample for each category, each interval (five seconds)</span>
    <span class="nx">chart2</span><span class="p">.</span><span class="nx">yDomain</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">cat</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// create randomized timestamp for this category data item</span>
      <span class="kd">var</span> <span class="nx">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">*</span> <span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">);</span>

      <span class="c1">// create new data item</span>
      <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">// complex data item; four attributes (type, color, opacity and size) are changing dynamically with each iteration (as an example)</span>
        <span class="nx">time</span>: <span class="kt">now</span><span class="p">,</span>
        <span class="nx">color</span>: <span class="kt">color</span><span class="p">(</span><span class="nx">d</span> <span class="o">%</span> <span class="mi">10</span><span class="p">),</span>
        <span class="nx">opacity</span>: <span class="kt">Math.max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">(),</span> <span class="mf">0.3</span><span class="p">),</span>
        <span class="nx">category</span>: <span class="kt">cat2</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
        <span class="c1">//type: shapes[Math.round(Math.random() * (shapes.length - 1))], // the module currently doesn&#39;t support dynamically changed svg types (need to add key function to data, or method to dynamically replace svg object – tbd)</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">&quot;circle&quot;</span><span class="p">,</span>
        <span class="nx">size</span>: <span class="kt">Math.max</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">12</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
      <span class="p">};</span>

      <span class="c1">// send the datum to the chart</span>
      <span class="nx">chart2</span><span class="p">.</span><span class="nx">datum</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>      
    <span class="p">});</span>

    <span class="c1">// drive data into the chart at average interval of five seconds</span>
    <span class="c1">// here, set the timeout to roughly five seconds</span>
    <span class="nx">timeout</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">timeScale</span><span class="p">(</span><span class="nx">normal</span><span class="p">()));</span>

    <span class="c1">// do forever</span>
    <span class="nx">dataGenerator</span><span class="p">();</span>

  <span class="p">},</span> <span class="nx">timeout</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// start the data generator</span>
<span class="nx">dataGenerator</span><span class="p">();</span>

<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre></div>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Solring Lin ",
  "url" : ".",
  "image": "images/profile.jpg",
  "description": "Technical notes and everything."
}
</script>

</body>
</html>